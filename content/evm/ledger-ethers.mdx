# Using Ledger wallet with ethers on Sei

Prerequisites:

1. Make sure you have the Sei app or Ethereum app installed on your Ledger device.
2. Enable blind signing in the Sei or Ethereum app settings (needed for precompile
   examples and working with contracts in general).
3. Linux users may need to add a udev rule to allow access to the device. You
   can find the script to add a rule in the Ledger repo
   [here](https://github.com/LedgerHQ/udev-rules).

## Governance precompile example

```tsx copy
import { LedgerSigner } from '@ethers-ext/signer-ledger';
import Transport from '@ledgerhq/hw-transport-node-hid';
import { ethers } from 'ethers';
import { GOVERNANCE_PRECOMPILE_ADDRESS, GOVERNANCE_PRECOMPILE_ABI } from '@sei-js/evm';

/// Deposit SEI into a governance proposal
const depositToProposal = async (signer: LedgerSigner, proposalId: number, amount: string) => {
  const gov = new ethers.Contract(GOVERNANCE_PRECOMPILE_ADDRESS, GOVERNANCE_PRECOMPILE_ABI, signer);
  const overrides = {
    // attach SEI to the call
    value: ethers.parseEther(amount)
  };
  try {
    const tx = await gov.deposit(proposalId, overrides);
    console.log('DepositResult:', tx);
  } catch (err) {
    console.error('Deposit failed:', err);
  }
};

/// Cast a vote on a governance proposal
const castVote = async (
  signer: LedgerSigner,
  proposalId: number,
  option: number // e.g. 1 = Yes, 2 = Abstain, 3 = No, 4 = No with Veto
) => {
  const gov = new ethers.Contract(GOVERNANCE_PRECOMPILE_ADDRESS, GOVERNANCE_PRECOMPILE_ABI, signer);
  try {
    const tx = await gov.vote(proposalId, option);
    console.log('VoteResult:', tx);
  } catch (err) {
    console.error('Vote failed:', err);
  }
};

const testGovernance = async () => {
  const rpcUrl = 'https://evm-rpc-testnet.sei-apis.com';
  const provider = new ethers.JsonRpcProvider(rpcUrl);
  const signer = new LedgerSigner(Transport, provider);

  const proposalId = 1; // replace with your target proposal ID
  const depositAmount = '5'; // SEI to deposit
  const voteOption = 1; // your vote choice

  // deposit SEI into the proposal
  await depositToProposal(signer, proposalId, depositAmount);
  // then cast your vote
  await castVote(signer, proposalId, voteOption);
};

testGovernance();
```

## Staking via precompile example

```tsx copy
import { LedgerSigner } from '@ethers-ext/signer-ledger';
import Transport from '@ledgerhq/hw-transport-node-hid';
import { ethers, toUtf8String } from 'ethers';

import { STAKING_PRECOMPILE_ABI, STAKING_PRECOMPILE_ADDRESS } from '@sei-js/evm';

const stake = async (signer: LedgerSigner, amount: string, fromAddress: string, validatorAddress: string) => {
  const contract = new ethers.Contract(STAKING_PRECOMPILE_ADDRESS, STAKING_PRECOMPILE_ABI, signer);
  const overrides = {
    from: fromAddress,
    value: ethers.parseEther(amount), //staking 3.5 sei
    gasLimit: ethers.parseEther('0.00000000001')
  };

  console.log('Staking ', overrides);
  contract.delegate(validatorAddress, overrides).then((result) => {
    console.log('DelegateResult: ', toUtf8String(result));
  });
};

const testStaking = async () => {
  const validatorAddress = 'seivaloperAddress';
  const rpcUrl = 'https://evm-rpc-testnet.sei-apis.com';

  const provider = new ethers.JsonRpcProvider(rpcUrl);
  const signer = new LedgerSigner(Transport, provider);

  const defaultAddress = await signer.getAddress();

  await stake(signer, '5', defaultAddress, validatorAddress); // stake 5 Sei
};

testStaking();
```
