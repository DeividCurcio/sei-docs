# Sei Node Performance Optimization

## Critical Performance Settings

### Database Optimization (app.toml)

```toml
[state-commit]
# Enable sei-db for 3x storage savings and better performance
sc-enable = true
# Improves block catch-up speed
sc-async-commit-buffer = 100

[state-store]
# Enable for historical queries
ss-enable = true
# Use PebbleDB for better performance
ss-backend = "pebbledb"
# Async writes for better throughput
ss-async-write-buffer = 100
```

### Memory Management (app.toml)

```toml
# Adjust IAVL cache size based on available RAM
# Default 50MB (781250). Increase for better performance
iavl-cache-size = 781250

# Enable inter-block caching
inter-block-cache = true
```

### Mempool Optimization (config.toml)

```toml
[mempool]
# Prevent mempool overflow
size = 10000
max-txs-bytes = 10737418240
cache-size = 10000
ttl-duration = "3s"
ttl-num-blocks = 5
pending-size = 5000
max-pending-txs-bytes = 1073741824
pending-ttl-duration = "3s"
pending-ttl-num-blocks = 5
```

### Network Settings (config.toml)

```toml
[p2p]
send-rate = 20480000
recv-rate = 20480000
max-packet-msg-payload-size = 10485760
max-connections = 200

[rpc]
max-open-connections = 900
max-subscription-clients = 100
max-subscriptions-per-client = 5
timeout-broadcast-tx-commit = "10s"
```

### File Descriptor Limits

Add to /etc/security/limits.conf:

```
*                soft    nofile          65535
*                hard    nofile          65535
```

And in systemd service:

```ini
[Service]
LimitNOFILE=65535
```

## Node Types and Storage

### Archive Node

```toml
# app.toml - When sei-db is disabled
pruning = "nothing"
min-retain-blocks = 0

# With sei-db enabled, pruning is ignored
# Control history with ss-keep-recent instead
ss-keep-recent = 0  # Keep all history
```

### Standard Node

```toml
# Default pruning with sei-db disabled
pruning = "default"

# With sei-db enabled
ss-keep-recent = 100000  # Keep last 100k blocks
```

## Recovery and Maintenance

### Regular Maintenance

- Monitor disk usage growth
- Check system resource utilization (CPU, RAM, IOPS)
- Review logs for "out of memory" or "too many open files" errors

### Performance Monitoring

```bash
# Check current connections
netstat -tnlp | grep seid

# Monitor system resources
htop

# Check disk I/O
iostat -xz 1
```
